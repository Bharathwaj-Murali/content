id: Threat Hunting - Generic
version: -1
contentitemexportablefields:
  contentitemfields: {}
name: Threat Hunting - Generic
description: "This playbook enables threat hunting for IOCs in your enterprise. It currently supports the following integrations: \n- Splunk\n- Qradar\n- Pan-os \n- Cortex data lake \n- Autofocus\n- Microsoft 365 Defender"
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: f7b21d57-eb4c-4233-8725-51010d27db08
    type: start
    task:
      id: f7b21d57-eb4c-4233-8725-51010d27db08
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "17"
      - "18"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 650,
          "y": -80
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 03b8e993-6134-41eb-8708-9e50e5a790fd
    type: playbook
    task:
      id: 03b8e993-6134-41eb-8708-9e50e5a790fd
      version: -1
      name: Splunk Indicator Hunting
      description: This playbook queries Splunk for indicators such as file hashes, IP addresses, domains, or urls. It outputs detected users, ip addresses, and hostnames related to the indicators.
      playbookName: Splunk Indicator Hunting
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      IPAddress:
        complex:
          root: inputs.IPAddress
          transformers:
          - operator: uniq
      IndexName:
        simple: '*'
      InternalDomainName:
        complex:
          root: inputs.InternalDomainName
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: inputs.InternalDomainName
                iscontext: true
          transformers:
          - operator: uniq
      InternalHostRegex:
        complex:
          root: inputs.InternalHostRegex
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: inputs.InternalHostRegex
                iscontext: true
      InternalIPRange:
        complex:
          root: inputs.InternalRange
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: inputs.InternalRange
                iscontext: true
          transformers:
          - operator: uniq
      MD5:
        complex:
          root: inputs.MD5
          transformers:
          - operator: uniq
      SHA1:
        complex:
          root: inputs.SHA1
          transformers:
          - operator: uniq
      SHA256:
        complex:
          root: inputs.SHA256
          transformers:
          - operator: uniq
      SelectFields:
        simple: source,timestamp
      URLDomain:
        complex:
          root: inputs.URLDomain
          transformers:
          - operator: uniq
      earliest_time:
        complex:
          root: inputs.SplunkEarliestTime
      event_limit:
        simple: "100"
      latest_time:
        complex:
          root: inputs.SplunkLatestTime
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 860,
          "y": 230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 369e31f3-133b-4b7d-8872-d17649667eb3
    type: playbook
    task:
      id: 369e31f3-133b-4b7d-8872-d17649667eb3
      version: -1
      name: Palo Alto Networks - Hunting And Threat Detection
      description: "This is a multipurpose playbook used for hunting and threat detection. The playbook receives inputs based on hashes, IP addresses, or domain names provided manually or from outputs by other playbooks. \nWith the received indicators, the playbook leverages data received by PANW products including, Cortex Data Lake, Autofocus and Pan-OS to search for IP addresses, host names and users related to the provided indicators.\nThe output provided by the playbook facilitates pivoting searches for possibly affected IP addresses or users."
      playbookName: Palo Alto Networks - Hunting And Threat Detection
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      IPAddresses:
        complex:
          root: inputs.IPAddress
          transformers:
          - operator: uniq
      InternalDomainName:
        complex:
          root: inputs.InternalDomainName
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: inputs.InternalDomainName
                iscontext: true
          transformers:
          - operator: uniq
      InternalHostRegex:
        complex:
          root: inputs.InternalHostRegex
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: inputs.InternalHostRegex
                iscontext: true
      InternalRange:
        complex:
          root: inputs.InternalRange
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: inputs.InternalRange
                iscontext: true
          transformers:
          - operator: uniq
      MD5:
        complex:
          root: inputs.MD5
          transformers:
          - operator: uniq
      SHA1:
        complex:
          root: inputs.SHA1
          transformers:
          - operator: uniq
      SHA256:
        complex:
          root: inputs.SHA256
          transformers:
          - operator: uniq
      URLDomain:
        complex:
          root: inputs.URLDomain
          transformers:
          - operator: uniq
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 20,
          "y": 230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 68569c89-2090-4873-8dbc-aede46966200
    type: title
    task:
      id: 68569c89-2090-4873-8dbc-aede46966200
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 650,
          "y": 900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 279db603-6d7b-4d19-811a-eb642b0b135c
    type: playbook
    task:
      id: 279db603-6d7b-4d19-811a-eb642b0b135c
      version: -1
      name: QRadar Indicator Hunting V2
      description: 'The Playbook queries QRadar SIEM for indicators such as file hashes, IP addresses, domains, or urls. '
      playbookName: QRadar Indicator Hunting V2
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      IPAddress:
        complex:
          root: inputs.IPAddress
          transformers:
          - operator: uniq
      InternalRange:
        complex:
          root: inputs.InternalRange
          filters:
          - - operator: isNotEmpty
              left:
                value:
                  simple: inputs.InternalRange
                iscontext: true
          transformers:
          - operator: uniq
      InvestigationIPFields:
        simple: sourceip,destinationip
      InvestigationUserFields:
        simple: username
      MD5:
        complex:
          root: inputs.MD5
          transformers:
          - operator: uniq
      QradarIPfield:
        simple: sourceip,destinationip
      SHA1:
        complex:
          root: inputs.SHA1
          transformers:
          - operator: uniq
      SHA256:
        complex:
          root: inputs.SHA256
          transformers:
          - operator: uniq
      TimeFrame:
        complex:
          root: inputs.QRadarTimeFrame
      URLDomain:
        complex:
          root: inputs.URLDomain
          transformers:
          - operator: uniq
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 440,
          "y": 230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: dbcde651-941f-42d6-81ea-dc70df6bba33
    type: playbook
    task:
      id: dbcde651-941f-42d6-81ea-dc70df6bba33
      version: -1
      name: Microsoft 365 Defender - Threat Hunting Generic
      description: |
        This playbook retrieves email data based on the `URLDomain`, `SHA256`, `IPAddress`. and `MessageID` inputs. The output is a unified object with all of the retrieved emails based on the following sub-playbooks outputs:

        - **Microsoft 365 Defender - Get Email URL clicks**:
                Retrieves data based on URL click events.


        - **Microsoft 365 Defender - Emails Indicators Hunt**:
                Retrieves data based on several different email events.

        Read the playbook's descriptions in order to get the full details.
      playbookName: Microsoft 365 Defender - Threat Hunting Generic
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      IPAddress:
        complex:
          root: inputs.IPAddress
          transformers:
          - operator: uniq
      MessageID:
        complex:
          root: inputs.MessageID
          transformers:
          - operator: uniq
      ResultsLimit:
        simple: "50"
      SHA256:
        complex:
          root: inputs.SHA256
          transformers:
          - operator: uniq
      SearchTimeframe:
        simple: "7"
      Timeout:
        simple: "180"
      URLDomain:
        complex:
          root: inputs.URLDomain
          transformers:
          - operator: uniq
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": -410,
          "y": 230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 3541bc13-e553-4e43-8677-8c8baed46647
    type: title
    task:
      id: 3541bc13-e553-4e43-8677-8c8baed46647
      version: -1
      name: Check Hunting Results
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "13"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 650,
          "y": 410
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "13":
    id: "13"
    taskid: f90d1d68-dcf7-4c38-889a-7a48fe552445
    type: condition
    task:
      id: f90d1d68-dcf7-4c38-889a-7a48fe552445
      version: -1
      name: Were Any Hunting Results Retrieved?
      description: Checks if any hunting results were retrieved.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "15"
      Indicators Hunting Results Exists:
      - "14"
      Vulnerability Hunting Results Exists:
      - "19"
      Vulnerability Hunting Results is Empty:
      - "20"
    separatecontext: false
    conditions:
    - label: Indicators Hunting Results Exists
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Microsoft365Defender
                accessor: RetrievedEmails
            iscontext: true
          right:
            value: {}
        - operator: isNotEmpty
          left:
            value:
              complex:
                root: Microsoft365Defender.RetrievedEmails
                accessor: NetworkMessageId
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              complex:
                root: QRadar
                accessor: DetectedUsers
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              complex:
                root: QRadar
                accessor: DetectedInternalIPs
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              complex:
                root: QRadar
                accessor: DetectedExternalIPs
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              complex:
                root: QRadar
                accessor: DetectedInternalHosts
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              complex:
                root: QRadar
                accessor: DetectedExternalHosts
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              complex:
                root: PANWHunting
                accessor: DetectedUsers
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              complex:
                root: PANWHunting
                accessor: DetectedInternalIPs
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              complex:
                root: PANWHunting
                accessor: DetectedExternalIPs
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              complex:
                root: PANWHunting
                accessor: DetectedInternalHosts
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              complex:
                root: PANWHunting
                accessor: DetectedExternalHosts
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              complex:
                root: Splunk
                accessor: DetectedUsers
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              complex:
                root: Splunk
                accessor: DetectedInternalIPs
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              complex:
                root: Splunk
                accessor: DetectedExternalIPs
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              complex:
                root: Splunk
                accessor: DetectedInternalHosts
            iscontext: true
        - operator: isNotEmpty
          left:
            value:
              complex:
                root: Splunk
                accessor: DetectedExternalHosts
            iscontext: true
    - label: Vulnerability Hunting Results Exists
      condition:
      - - operator: isNotEmpty
          left:
            value:
              complex:
                root: Endpoint
            iscontext: true
    - label: Vulnerability Hunting Results is Empty
      condition:
      - - operator: isEmpty
          left:
            value:
              complex:
                root: Endpoint
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 650,
          "y": 560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: a8a67e08-052e-42b4-8d64-9f9c8649dcfe
    type: regular
    task:
      id: a8a67e08-052e-42b4-8d64-9f9c8649dcfe
      version: -1
      name: Set 'HasResults.Indicators' to True
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: HasResults.Indicators
      value:
        simple: "True"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 430,
          "y": 730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: 46a9d980-28ad-4b85-8666-326f7073584b
    type: regular
    task:
      id: 46a9d980-28ad-4b85-8666-326f7073584b
      version: -1
      name: Set 'HasResults.Indicators' to False
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: HasResults.Indicators
      value:
        simple: "False"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 10,
          "y": 730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: d80978f0-c6ad-49f8-8d6f-4093b00ed2d7
    type: playbook
    task:
      id: d80978f0-c6ad-49f8-8d6f-4093b00ed2d7
      version: -1
      name: Search Endpoint by CVE - Generic
      playbookName: Search Endpoint by CVE - Generic
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      CVE_ID:
        complex:
          root: inputs.CVE_ID
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 1280,
          "y": 230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: a16f48ba-4fc3-4ce8-8ac1-f89a682bc3ad
    type: title
    task:
      id: a16f48ba-4fc3-4ce8-8ac1-f89a682bc3ad
      version: -1
      name: Indicators Hunting
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "6"
      - "3"
      - "5"
      - "2"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 20,
          "y": 60
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: 0b40d9c2-57ff-4e5a-800b-5801e099c93a
    type: title
    task:
      id: 0b40d9c2-57ff-4e5a-800b-5801e099c93a
      version: -1
      name: Vulnerability Hunting
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "16"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1280,
          "y": 60
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: 44663910-9c5c-4c40-8cce-6dde8f6aa873
    type: regular
    task:
      id: 44663910-9c5c-4c40-8cce-6dde8f6aa873
      version: -1
      name: Set 'HasResults.Vulnerability' to True
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: HasResults.Vulnerability
      value:
        simple: "True"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 880,
          "y": 730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 451f9225-970f-4867-86d7-b02ea132b66b
    type: regular
    task:
      id: 451f9225-970f-4867-86d7-b02ea132b66b
      version: -1
      name: Set 'HasResults.Vulnerability' to False
      description: |-
        Set a value in context under the key you entered. If no value is entered, the script doesn't do anything.

        This automation runs using the default Limited User role, unless you explicitly change the permissions.
        For more information, see the section about permissions here:
        https://docs.paloaltonetworks.com/cortex/cortex-xsoar/6-2/cortex-xsoar-admin/playbooks/automations.html
      scriptName: SetAndHandleEmpty
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      append:
        simple: "false"
      key:
        simple: HasResults.Vulnerability
      value:
        simple: "False"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1320,
          "y": 730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "13_14_Indicators Hunting Results Exists": 0.88,
      "13_15_#default#": 0.86
    },
    "paper": {
      "dimensions": {
        "height": 1045,
        "width": 2110,
        "x": -410,
        "y": -80
      }
    }
  }
inputs:
- key: MD5
  value: {}
  required: false
  description: The MD5 hash file or an array of hashes to search.
  playbookInputQuery:
- key: SHA256
  value: {}
  required: false
  description: The SHA256 hash file or an array of hashes to search.
  playbookInputQuery:
- key: SHA1
  value: {}
  required: false
  description: The SHA1 hash file or an array of hashes to search.
  playbookInputQuery:
- key: IPAddress
  value: {}
  required: false
  description: |
    The source or destination IP address to search. Can be a single address or an array of list of addresses.
  playbookInputQuery:
- key: URLDomain
  value: {}
  required: false
  description: Domain or URL to search. Can be a single domain or URL or an array of domains or URLs to search. By default, the LIKE clause is used.
  playbookInputQuery:
- key: InternalRange
  value: {}
  required: false
  description: 'A comma-separated list of internal IP ranges to check IP addresses against. The list should be provided in CIDR notation. An example of a list of ranges would be: "172.16.0.0/12,10.0.0.0/8,192.168.0.0/16" (without quotes). If a list is not provided, uses the default list provided in the IsIPInRanges script (the known IPv4 private address ranges).'
  playbookInputQuery:
- key: InternalDomainName
  value: {}
  required: false
  description: The organization's internal domain name. This is provided for the script IsInternalHostName that checks if the detected hostnames are internal or external, if the hosts contain the internal domains suffix. For example, paloaltonetworks.com. If there is more than one domain, use the | character to separate values such as (paloaltonetworks.com|test.com).
  playbookInputQuery:
- key: InternalHostRegex
  value: {}
  required: false
  description: Provided for the script IsInternalHostName that checks if the detected host names are internal or external, if the hosts match the organization's naming convention. For example, the host testpc1 will have the following regex \w{6}\d{1}
  playbookInputQuery:
- key: QRadarTimeFrame
  value:
    simple: LAST 7 DAYS
  required: false
  description: The time frame to search in QRadar.
  playbookInputQuery:
- key: SplunkEarliestTime
  value:
    simple: -7d@d
  required: false
  description: The earliest time to search in Splunk.
  playbookInputQuery:
- key: SplunkLatestTime
  value:
    simple: now
  required: false
  description: The latest time to search in Splunk.
  playbookInputQuery:
- key: MessageID
  value: {}
  required: false
  description: "This input will be used in the \"Microsoft 365 Defender - Get Email URL clicks\" playbook. MessageID of the email from which the URL was clicked. Please note that this can be either of the following 2 values:\n- The value of the header \"Message-ID\".\n- The internal ID of the message within Microsoft's products (e.g. \n NetworkMessageId).\n\nCan be a single MessageID or an array of MessageIDs to search."
  playbookInputQuery:
- key: CVE_ID
  value: {}
  required: false
  description: |-
    Hunt for assets with a given CVE using available tools.
    Separate multiple search values by commas only (without spaces or any special characters).
  playbookInputQuery:
outputs:
- contextPath: Splunk.DetectedUsers
  description: Users detected based on the username field in your search.
  type: string
- contextPath: Splunk.DetectedInternalIPs
  description: Internal IP addresses detected by your search.
  type: string
- contextPath: Splunk.DetectedExternalIPs
  description: External IP addresses detected by your search.
  type: string
- contextPath: Splunk.DetectedInternalHosts
  description: Internal hostnames detected based on the fields in your search.
  type: string
- contextPath: Splunk.DetectedExternalHosts
  description: External hostnames detected based on the fields in your search.
  type: string
- contextPath: PANWHunting.DetectedUsers
  description: User or array of users that were detected during hunting.
  type: string
- contextPath: PANWHunting.DetectedInternalIPs
  description: Internal IP addresses detected based on fields and inputs in your search.
  type: string
- contextPath: PANWHunting.DetectedExternalIPs
  description: External IP addresses detected based on fields and inputs in your search.
  type: string
- contextPath: PANWHunting.DetectedInternalHosts
  description: Internal hostnames detected based on fields and inputs in your search.
  type: string
- contextPath: PANWHunting.DetectedExternalHosts
  description: External hostnames detected based on fields and inputs in your search.
  type: string
- contextPath: QRadar.DetectedUsers
  description: Users detected based on the username field in your search.
  type: string
- contextPath: QRadar.DetectedInternalIPs
  description: Internal IP addresses detected based on fields and inputs in your search.
  type: string
- contextPath: QRadar.DetectedExternalIPs
  description: External IP addresses detected based on fields and inputs in your search.
  type: string
- contextPath: QRadar.DetectedInternalHosts
  description: Internal host names detected based on hosts in your assets table. Note that the data accuracy depends on how the asset mapping is configured in QRadar.
  type: string
- contextPath: QRadar.DetectedExternalHosts
  description: External host names detected based on hosts in your assets table. Note that the data accuracy depends on how the asset mapping is configured in QRadar.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails
  description: Email objects containing relevant fields.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.InternetMessageId
  description: Internet Message ID of the email.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.SenderFromDomain
  description: Sender domain.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.EmailDirection
  description: Email direction (inbound/outbound).
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.DeliveryLocation
  description: Delivery location.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.AuthenticationDetails
  description: Authentication details (SPF, DKIM, DMARC, CompAuth)
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.DeliveryAction
  description: Email subject.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.AttachmentCount
  description: Number of attachments.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.ThreatNames
  description: Threat names.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.RecipientEmailAddress
  description: Recipient email address.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.EmailAction
  description: Email action.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.EmailLanguage
  description: Email language.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.SenderFromAddress
  description: Sender address.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.Timestamp
  description: Timestamp.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.SenderDisplayName
  description: Sender display name.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.SenderIPv4
  description: Sender IPv4.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.ConfidenceLevel
  description: Threat types.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.SHA256
  description: SHA256 of the attachments (if exist in the email).
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.Url
  description: URLs found in the email's body.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.UrlCount
  description: Number of URLs found in the email's body.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.SenderIPv6
  description: Sender IPv6.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.AccountUpn
  description: User principal name (UPN) of the account.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.IsClickedThrough
  description: Indicates whether the user was able to click through to the original URL or not.
  type: number
- contextPath: Microsoft365Defender.RetrievedEmails.BulkComplaintLevel
  description: Threshold assigned to email from bulk mailers, a high bulk complain level (BCL) means the email is more likely to generate complaints, and thus more likely to be spam.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.IPAddress
  description: IP address assigned to the device during communication.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.DetectionMethods
  description: Methods used to detect whether the URL contains or leads to malware, phishing, or other threats.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.ActionType
  description: Type of activity that triggered the event.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.UrlChain
  description: List of URLs in the redirection chain.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.NetworkMessageId
  description: Unique identifier for the email, generated by Office 365.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.DisplayName
  description: Name of the sender displayed in the address book, typically a combination of a given or first name, a middle initial, and a last name or surname.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.SenderMailFromDomain
  description: Sender domain in the MAIL FROM header, also known as the envelope sender or the Return-Path address.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.SenderMailFromAddress
  description: Sender email address in the MAIL FROM header, also known as the envelope sender or the Return-Path address.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.Subject
  description: Subject of the email.
  type: string
- contextPath: Microsoft365Defender.RetrievedEmails.ThreatTypes
  description: Verdict from the email filtering stack on whether the email contains malware, phishing, or other threats.
  type: unknown
- contextPath: HasResults.Indicators
  description: Indicates whether any results were retrieved for the indicator's threat hunting queries.
  type: unknown
- contextPath: HasResults.Vulnerability
  description: Indicates whether any results were retrieved for the vulnerability threat hunting queries.
  type: unknown
- contextPath: Endpoint
  description: Global compromised Assets
  type: unknown
tests:
- No tests (auto formatted)
fromversion: 6.5.0
